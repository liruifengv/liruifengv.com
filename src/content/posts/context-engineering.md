---
title: AI 新技能不是提示词工程，而是上下文工程
author: liruifengv
description: AI 新技能不是提示词工程，而是上下文工程
pubDatetime: 2025-07-11
featured: true
draft: false
tags:
  - AI
---

上下文工程（Context Engineering）是 AI 领域中一个新兴的热门概念。讨论正在从 “提示词工程” 转向一个更广泛、更强大的概念：**上下文工程**。[Tobi Lutke](https://x.com/tobi/status/1935533422589399127) 将其描述为 “提供所有必要上下文以使 LLM 能够合理解决任务的艺术”，他说得很对。

随着 Agent 的兴起，我们加载到 “有限工作记忆” 中的信息变得更加重要。我们看到，决定 Agent 成功或失败的主要因素是你提供给它的上下文质量。大多数 Agent 失败不再是模型失败，而是上下文失败。

## 什么是上下文？

要理解上下文工程，我们必须首先扩展对 “上下文” 的定义。它不仅仅是你发送给 LLM 的单个提示词。可以把它想象成模型在生成响应之前看到的所有内容。

![上下文](https://bucket.liruifengv.com/context-engineering/context.png)

- **指令/系统提示词**：定义模型在对话过程中行为的初始指令集，可以/应该包括示例、规则等。

- **用户提示词**：来自用户的即时任务或问题。

- **状态/历史（短期记忆）**：当前对话，包括导致此时刻的用户和模型响应。

- **长期记忆**：持久的知识库，从许多先前的对话中收集，包含学习到的用户偏好、过去项目的摘要或被告知要记住以供将来使用的事实。

- **检索信息（RAG）**：外部的、最新的知识，来自文档、数据库或 API 的相关信息，用于回答特定问题。

- **可用工具**：所有它可以调用的函数或内置工具的定义（例如，check_inventory、send_email）。

- **结构化输出**：对模型响应格式的定义，例如 JSON 对象。

## 为什么重要：从廉价版 Demo 变成惊艳的产品

构建真正有效的 AI Agent 的秘诀与你编写的代码复杂性关系不大，而与你提供的上下文质量有关。

构建 Agent 与你编写的代码或使用的框架关系不大。廉价的 Demo 和 “惊艳的” Agent 之间的区别在于你提供的上下文质量。想象一个 AI 助手被要求根据一封简单的邮件安排会议：

> “嘿，只是想看看你明天是否有空进行快速同步。”

**“廉价 Demo 版” Agent** 上下文很差。它只看到用户的请求，其他什么都没有。它的代码可能完全正常——它调用 LLM 并获得响应——但输出是无用的和机械的：

> “感谢您的消息。明天对我来说没问题。我可以问一下您想的是什么时间吗？”

**“惊艳版” Agent** 由丰富的上下文驱动。代码的主要工作不是找出如何响应，而是收集 LLM 需要完成其目标的信息。在调用 LLM 之前，你会扩展上下文以包括

- 你的日历信息（显示你的日程已满）。

- 你与这个人的过往邮件（确定适当的非正式语调）。

- 你的联系人列表（识别他们为关键合作伙伴）。

- 用于 send_invite 或 send_email 的工具。

然后你可以生成响应。

> “嘿，Jim！明天我这边排得满满的，整天都是背靠背的会议。周四上午有空，如果对你合适的话？已经发送了邀请，让我知道是否可行。”

神奇之处不在于更智能的模型或更聪明的算法。它在于为正确的任务提供正确的上下文。这就是为什么上下文工程很重要。Agent 失败不仅仅是模型失败；它们是上下文失败。

## 从提示词到上下文工程

什么是上下文工程？虽然 “提示词工程” 专注于在单个文本字符串中制作完美的指令集，但上下文工程要广泛得多。让我们简单地说：

> “上下文工程是设计和构建动态系统的学科，该系统在正确的时间以正确的格式提供正确的信息和工具，为 LLM 提供完成任务所需的一切。”

上下文工程是

- **一个系统，而不是字符串**：上下文不仅仅是静态提示词模板。它是在主 LLM 调用之前运行的 **系统** 的输出。

- **动态的**：即时创建，针对即时任务量身定制。对于一个请求，这可能是日历数据，对于另一个可能是电子邮件或网络搜索。

- **关于在正确时间提供正确信息和工具**：核心工作是确保模型不会错过关键细节（“垃圾进，垃圾出”）。这意味着只在需要和有帮助时提供知识（信息）和能力（工具）。

- **格式很重要**：如何呈现信息很重要。简洁的摘要比原始数据转储更好。清晰的工具架构比模糊的指令更好。

## 结论

构建强大可靠的 AI Agent 越来越不取决于找到一个神奇的提示词或模型更新，而是取决于上下文工程以及在正确的时间以正确的格式提供正确的信息和工具。这是一个跨功能的挑战，涉及理解你的业务用例、定义你的输出，以及构建所有必要的信息，使 LLM 能够 “完成任务”。

## 致谢

本概述是通过深入和手动研究创建的，从几个优秀资源中汲取灵感和信息，包括：

- [Tobi Lutke tweet](https://x.com/tobi/status/1935533422589399127)
- [Karpathy tweet](https://x.com/karpathy/status/1937902205765607626)
- [The rise of "context engineering"](https://blog.langchain.com/the-rise-of-context-engineering/)
- [Own your context window](https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-03-own-your-context-window.md)
- [Context Engineering by Simon Willison](https://simonwillison.net/2025/Jun/27/context-engineering/)
- [Context Engineering for Agents](https://rlancemartin.github.io/2025/06/23/context_engineering/)
